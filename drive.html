<!doctype html>
<html lang='nl'>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Driving</title>
<link rel='stylesheet' href='css/style.css'>
</head>
<body class='neon-bg'>
<div id='ui' style='position:fixed;left:12px;top:12px;z-index:6;color:#fff'><a class='btn' href='index.html'>← Terug</a></div>
<script type='module'>
import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.module.js';
/* Driving */
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 2000);
const renderer = new THREE.WebGLRenderer({antialias:true, powerPreference:"high-performance"});
renderer.setSize(innerWidth, innerHeight); document.body.appendChild(renderer.domElement);
window.addEventListener("resize", ()=>{ camera.aspect = innerWidth/innerHeight; camera.updateProjectionMatrix(); renderer.setSize(innerWidth, innerHeight); });
scene.add(new THREE.AmbientLight(0x888888)); const sun = new THREE.DirectionalLight(0xffffff,1); sun.position.set(10,20,10); scene.add(sun);

let car = null;
(async()=>{ const gl = await loadGLTF('assets/models/car.glb'); if(gl && gl.scene){ car = gl.scene; car.scale.set(1,1,1); car.position.set(0,0,6); scene.add(car);} else { car = new THREE.Mesh(new THREE.BoxGeometry(2.4,0.9,4), new THREE.MeshStandardMaterial({color:0xffaa00})); car.position.set(0,0,6); scene.add(car);} })();

camera.position.set(0,6,14);
let vel=0, accel=0, maxSpeed=60, dist=0;
function update(dt, keys){
  if(keys['w']||keys['ArrowUp']) accel = 30; else if(keys['s']||keys['ArrowDown']) accel = -40; else accel = -6;
  vel += accel * dt; vel = Math.max(-8, Math.min(maxSpeed, vel));
  if(keys['a']||keys['ArrowLeft']) car.rotation.y += 1.4 * dt * (1 - Math.abs(vel)/maxSpeed);
  if(keys['d']||keys['ArrowRight']) car.rotation.y -= 1.4 * dt * (1 - Math.abs(vel)/maxSpeed);
  const forward = new THREE.Vector3(0,0,-1).applyQuaternion(car.quaternion);
  car.position.addScaledVector(forward, vel*dt);
  dist += Math.abs(vel*dt);
}
function render(){ renderer.render(scene, camera); }
const engine = new Engine((dt,keys)=>update(dt,keys), ()=>render());
</script>
</body>
</html>
